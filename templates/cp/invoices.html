{% extends 'cp_base.html' %}
{% load cp_tags %}

{% block extrahead %}
{{ block.super }}
<script>
var caller = 'invoices';
</script>
<script type="text/javascript" src="{{ MEDIA_URL }}js/order_processing.js"></script>
<script>
backend_url = '/cp/position/edit/invoice/';
</script>
{% endblock %}

{% block content %}
<h1>Инвойсы</h1>
<form method="{{ filter.method }}">
<input type="hidden" name="qs_filter" value="1">
<input type="submit" value="Фильтр">
<input type="submit" name="qs_filter_clear" value="Очистить">
Количество записей на странице: 
<select onchange="location.href='{{ request.path }}?items_per_page=' + this.value">
<option value="20"{% ifequal items_per_page 20 %} selected {% endifequal %}>20</option>
<option value="50"{% ifequal items_per_page 50 %} selected {% endifequal %}>50</option>
<option value="100"{% ifequal items_per_page 100 %} selected {% endifequal %}>100</option>
</select>
<table class="admin_table">
<tr>
{% table_header_sort headers %}
</tr>
<tr{% if filter.is_set %} style="border: solid 2px green;"{% endif %}>
<td>&nbsp;</td>
<td><nobr>{{ filter.form.po__user__username__icontains }}: {{ filter.form.po__po__icontains }}</nobr></td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
{% for invoice in invoices %}
<tr>
	<td>{{ invoice.id }}</td>
	<td>{{ invoice.po }}</td>
	<td>{{ invoice.created|date }}</td>
	<td>{{ invoice.get_item_sum }}</td>
	<td class="editable" onclick="editPlacesNum({{ invoice.id }})">
		<div id="places_num_display_{{ invoice.id }}">{{ invoice.places_num|default:"" }}</div>
		<div id="places_num_{{ invoice.id }}" style="display: none">{{ invoice.places_num|default:"" }}</div>
		<div id="places_num_buttons_{{ invoice.id }}" style="display: none"><button onclick="save(); return false;">Save</button><button onclick="cancel()">Cancel</button></div>
	</td>
	<td class="editable" onclick="editWeightKg({{ invoice.id }})">
	    <div id="weight_kg_display_{{ invoice.id }}">{{ invoice.weight_kg|default:"" }}</div>
        <div id="weight_kg_{{ invoice.id }}" style="display: none">{{ invoice.weight_kg|default:"" }}</div>
        <div id="weight_kg_buttons_{{ invoice.id }}" style="display: none"><button onclick="save(); return false;">Save</button><button onclick="cancel()">Cancel</button></div>
	</td>
	<td class="editable" onclick="editShippingCost({{ invoice.id }})">
	    <div id="shipping_cost_display_{{ invoice.id }}">{{ invoice.shipping_cost|default:"" }}</div>
        <div id="shipping_cost_{{ invoice.id }}" style="display: none">{{ invoice.shipping_cost|default:"" }}</div>
        <div id="shipping_cost_buttons_{{ invoice.id }}" style="display: none"><button onclick="save(); return false;">Save</button><button onclick="cancel()">Cancel</button></div>
	</td>
	<td>
		<a class="change_link black" href="/cp/invoice/{{ invoice.id }}/?next={{ next }}">Просмотр</a>&nbsp;|&nbsp;
		<a class="export_link black" target="_blank" href="/cp/invoice-export/{{ invoice.id }}">Экспорт</a>
	</td>
</tr>
{% endfor %}
</table>
</form>
{% include 'paginator.html' %}
{% endblock %}